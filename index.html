<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø© - Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --bg: #f4f7f6; --success: #27ae60; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; }
        .card { background: white; max-width: 850px; margin: auto; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); position: relative; }
        .admin-btn { position: absolute; top: 20px; left: 20px; background: #95a5a6; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 12px; }
        h2 { color: var(--primary); border-bottom: 4px solid var(--accent); display: inline-block; padding-bottom: 10px; }
        .section { margin-top: 25px; padding: 20px; border-radius: 15px; background: #fff; border: 1px solid #eee; }
        .upload-area { border: 2px dashed var(--accent); background: #f0f9ff; }
        input[type="text"], input[type="password"] { padding: 12px; width: 80%; border: 2px solid #ddd; border-radius: 10px; font-size: 1.1em; text-align: center; margin: 10px 0; }
        button { background: var(--accent); color: white; border: none; padding: 15px 30px; border-radius: 10px; cursor: pointer; font-weight: bold; width: 85%; transition: 0.3s; }
        button:hover { opacity: 0.9; transform: translateY(-2px); }
        .btn-danger { background: #e74c3c; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #eee; padding: 12px; text-align: center; }
        th { background: var(--primary); color: white; }
        .result-header { font-size: 1.4em; font-weight: bold; color: var(--accent); margin: 20px 0; }
        .advice-box { margin-top: 20px; padding: 15px; border-radius: 10px; line-height: 1.6; text-align: right; }
        .excellent { background: #def7ec; color: #03543f; border: 1px solid #84e1bc; }
        .low { background: #fde8e8; color: #9b1c1c; border: 1px solid #f8b4b4; }
        .footer { margin-top: 40px; font-size: 0.9em; color: #777; border-top: 1px solid #eee; padding-top: 20px; text-align: center; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="card">
    <button class="admin-btn" onclick="toggleAdmin()">ğŸ”§ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
    <div style="text-align: center;">
        <h2>Ù…Ù†ØµØ© Ù†ØªØ§Ø¦Ø¬ Ù…Ø¯Ø±Ø³Ø© Ø·Ù‡ Ø­Ø³ÙŠÙ†</h2>
        <p>Ù…Ø§Ø¯Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© | Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</p>
    </div>

    <div id="adminPanel" class="section hidden">
        <h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø³ØªØ§Ø°</h3>
        <input type="password" id="adminPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <button onclick="verifyAdmin()">Ø¯Ø®ÙˆÙ„</button>
    </div>

    <div id="uploadPanel" class="section upload-area hidden">
        <p><b>Ø£Ù‡Ù„Ø§Ù‹ Ø£Ø³ØªØ§Ø° Ø¨Ù„ÙƒØ§Ù†ÙŠ!</b> Ø§Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø³ØªÙ…Ø±Ø© (Excel)</p>
        <input type="file" id="excelFile" accept=".xlsx, .xls">
        <div id="status"></div>
        <button class="btn-danger" onclick="clearData()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>

    <div id="searchPanel" class="section">
        <p>Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ù…Ø³Ø§Ø± Ù„Ù„Ø§Ø·Ù„Ø§Ø¹ Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬ØªÙƒ (Ù…Ø«Ù„Ø§Ù‹: G162048433)</p>
        <input type="text" id="studentID" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ù‡Ù†Ø§...">
        <button onclick="searchResult()">Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
    </div>

    <div id="output"></div>

    <div class="footer">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© - Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ø·ÙŠÙ Ø¨Ù„ÙƒØ§Ù†ÙŠ Â© 2025</div>
</div>

<script>
    const ADMIN_PASS = "belgani2025";
    const DB_KEY = "belgani_data";

    function toggleAdmin() { document.getElementById('adminPanel').classList.toggle('hidden'); }

    function verifyAdmin() {
        if (document.getElementById('adminPass').value === ADMIN_PASS) {
            document.getElementById('uploadPanel').classList.remove('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
        } else { alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!"); }
    }

    document.getElementById('excelFile').addEventListener('change', function(e) {
        const reader = new FileReader();
        reader.onload = function(event) {
            const data = new Uint8Array(event.target.result);
            const workbook = XLSX.read(data, {type: 'array'});
            const sheet = workbook.Sheets[workbook.SheetNames[0]];
            const json = XLSX.utils.sheet_to_json(sheet, {header: 1});
            processExcel(json);
        };
        reader.readAsArrayBuffer(e.target.files[0]);
    });

    function processExcel(data) {
        let db = {};
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù‡ÙŠÙƒÙ„Ø© Ù…Ù„ÙÙƒ (Ø§Ù„Ø±Ù…Ø² Ø³Ø·Ø± 8ØŒ Ø§Ù„Ø§Ø³Ù… Ø³Ø·Ø± 11)
        for (let c = 4; c <= 73; c++) {
            let id = data[7] ? String(data[7][c]).trim().toUpperCase() : "";
            let name = data[10] ? String(data[10][c]).trim() : "";
            if (id && id.startsWith('G')) {
                let grades = [];
                for (let r = 11; r <= 24; r++) {
                    grades.push({ sub: data[r][3] || "Ù…ÙƒÙˆÙ†", score: data[r][c] || "--" });
                }
                db[id] = { name: name, grades: grades, avg: data[25][c] || "--" };
            }
        }
        localStorage.setItem(DB_KEY, JSON.stringify(db));
        document.getElementById('status').innerHTML = "âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!";
    }

    function searchResult() {
        const id = document.getElementById('studentID').value.trim().toUpperCase();
        const db = JSON.parse(localStorage.getItem(DB_KEY) || "{}");
        const s = db[id];
        const out = document.getElementById('output');

        if (s) {
            let h = `<div class="result-header">Ø§Ù„Ù…ØªØ¹Ù„Ù…(Ø©): ${s.name}</div><table><tr><th>Ø§Ù„Ù…ÙƒÙˆÙ†</th><th>Ø§Ù„Ù†Ù‚Ø·Ø©</th></tr>`;
            s.grades.forEach(g => { h += `<tr><td>${g.sub}</td><td><b>${g.score}</b></td></tr>`; });
            h += `<tr style="background:#eef2f7; font-weight:bold;"><td>Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¹Ø§Ù…</td><td>${s.avg}</td></tr></table>`;
            
            let adviceClass = parseFloat(s.avg) >= 5 ? "excellent" : "low";
            let adviceText = parseFloat(s.avg) >= 5 ? "Ù…Ù…ØªØ§Ø²! Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ø¬ØªÙ‡Ø§Ø¯Ùƒ." : "ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©ØŒ Ø¨Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙÙŠ Ø§Ù„Ù…Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©.";
            h += `<div class="advice-box ${adviceClass}"><b>ØªÙˆØ¬ÙŠÙ‡:</b> ${adviceText}</div>`;
            out.innerHTML = h;
        } else {
            out.innerHTML = "<p style='color:red;'>Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ù…Ø² Ø£Ùˆ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø³ØªØ§Ø°.</p>";
        }
    }

    function clearData() { if(confirm("Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")) { localStorage.removeItem(DB_KEY); location.reload(); } }
</script>
</body>
</html>
